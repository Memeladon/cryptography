# ГОСТ 34.10-2018 (полное название: «ГОСТ 34.10-2018. Информационная технология. Криптографическая защита информации.
# Процессы формирования и проверки электронной цифровой подписи», англ. «Information technology. Cryptographic data
# security. Signature and verification processes of electronic digital signature») — действующий межгосударственный
# криптографический стандарт, описывающий алгоритмы формирования и проверки электронной цифровой подписи реализуемой
# с использованием операций в группе точек эллиптической кривой, определенной над конечным простым полем. Стандарт
# разработан на основе национального стандарта Российской Федерации ГОСТ Р 34.10-2012 и введен в действие с 1 июня
# 2019 года приказом Росстандарта № 1059-ст от 4 декабря 2018 года.

"""
(venv) PS D:\Dev\Python_work\cryptography\gost3410-util> python shell.py
Welcome to GOST 34.10-2012 signature util v1.0.0 shell. Type help or ? to list commands.

[] ~# help

Documented commands (type help <topic>):
========================================
clear  delkey  exit  genkeys  help  keylist  sign  use  verify

[] ~# genkeys
 Please, select Curve params:

 1: GostR3410_2012_TC26_ParamSetA
         p FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF...FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC7
         q FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF...116FF22B8D4E0560609B4B38ABFAD2B85DCACDB1411F10B275
         a FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF...FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFDC4
         b E8C2505DEDFC86DDC1BD0B2B6667F1DA34B82574761CB0E879...614CB4574010DA90DD862EF9D4EBEE4761503190785A71C760
         x 00000000000000000000000000000000000000000000000000...00000000000000000000000000000000000000000000000003
         y 7503CFE87A836AE3A61B8816E25450E6CE5E1C93ACF1ABC177...E93D75E6A50E3A41E98028FE5FC235F5B889A589CB5215F2A4

 2: GostR3410_2012_TC26_ParamSetB
         p 80000000000000000000000000000000000000000000000000...0000000000000000000000000000000000000000000000006F
         q 80000000000000000000000000000000000000000000000000...45ACFDB77BD9D40CFA8B996712101BEA0EC6346C54374F25BD
         a 80000000000000000000000000000000000000000000000000...0000000000000000000000000000000000000000000000006C
        49613768672964538097858786894304605639173651970611...30173601718803721762099839631991880699725075683020 (1023 bits)
Curve:
        p: 13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083527 (512 bits)
        q: 13407807929942597099574024998205846127479365820592...28612556596899500625279906416653993875474742293109 (512 bits)
        a: 13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083524 (512 bits)
        b: 12190580024266230156189424758340094075514844064736...39088997221609947354520590448683948135300824418144 (512 bits)
        x: 3 (2 bits)
        y: 61285671321593683755506766505341533718267088079063...05107369028606191097747738367571924466694236795556 (511 bits)


[] ~# use 1
[keys(1)] ~# sign ./testdata/lorem.txt
Message hash: b'5e2f1111c66143fd28b901b3de4a5f15ffd76d4e8426550bacfde36e231b6efb'

Generated ASN.1 file:

SignatureSequence:
 params=KeyDataSet:
  keydatasquence=KeyDataSequence:
   text=gostSignKey
   algo=80060700
   open_key=OpenKey:
    x=39263492211321614783017449085797399284218600200319...32329605588963738336354784725356121153406504811724
    y=55315313634410924567003808321751343824209759608938...37548278676575816226077526952759326865614630269865

   cryptosystem_p=CryptosystemParams:
    p=13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083527

   curve_p=CurveParams:
    a=13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083524
    b=12190580024266230156189424758340094075514844064736...39088997221609947354520590448683948135300824418144

   dots_p=DotsParams:
    x=3
    y=61285671321593683755506766505341533718267088079063...05107369028606191097747738367571924466694236795556

   q=13407807929942597099574024998205846127479365820592...28612556596899500625279906416653993875474742293109


 sign=SignatureParamsSequence:
  r=90142725694372740340153895274007278371096453473898...83658615846900003311431311301982707948815080917955
  s=61147245657555030144825972588856017218539421232110...07368000172640986960292297672736615572572354192071

 meta=FileMetaSequence:
  filesize=3734
  filename=lorem.txt



Signature created!

[keys(1)] ~# verify ./testdata/lorem.txt ./testdata/lorem.txt.sign

Read ASN.1 file:

SignatureSequence:
 params=KeyDataSet:
  keydatasquence=KeyDataSequence:
   text=gostSignKey
   algo=80060700
   open_key=OpenKey:
    x=39263492211321614783017449085797399284218600200319...32329605588963738336354784725356121153406504811724
    y=55315313634410924567003808321751343824209759608938...37548278676575816226077526952759326865614630269865

   cryptosystem_p=CryptosystemParams:
    p=13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083527

   curve_p=CurveParams:
    a=13407807929942597099574024998205846127479365820592...31858186486050853753882811946569946433649006083524
    b=12190580024266230156189424758340094075514844064736...39088997221609947354520590448683948135300824418144

   dots_p=DotsParams:
    x=3
    y=61285671321593683755506766505341533718267088079063...05107369028606191097747738367571924466694236795556

   q=13407807929942597099574024998205846127479365820592...28612556596899500625279906416653993875474742293109


 sign=SignatureParamsSequence:
  r=90142725694372740340153895274007278371096453473898...83658615846900003311431311301982707948815080917955
  s=61147245657555030144825972588856017218539421232110...07368000172640986960292297672736615572572354192071

 meta=FileMetaSequence:
  filesize=3734
  filename=lorem.txt



Signature checking successful!

[keys(1)] ~# exit
"""